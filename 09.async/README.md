# Задание 9
## Переработать программу для пакетной обработки команд таким образом, чтобы:
### 1. команды обрабатывались многопоточно
### 2. ввод данных управлялся внешним кодом.

---

Команды считываются построчно из стандартного ввода и обрабатываются блоками по N команд.
Одна команда - одна строка, конкретное значение роли не играет. Если данные закончились - блок завершается принудительно. Параметр N передается как единственный параметр командной строки в виде целого числа.

1. При старте программы должно быть создано в дополнение к существующему основному потоку
ещё три дополнительных:
- log – поток для вывода данных в консоль
- file1 – первый поток для вывода в файл
- file2 – второй поток для вывода в файл

2. Инициатором обмена будет выступать внешний код. Вместо привычной точки входа в приложение
main() будут три внешних функции connect(), receive() и disconnect().

---

## Реализовано:

Библиотека asynclib предоставляет обертку над рабочими классами, позволяя запускать их в виде отдельных контекстов с помощью команд connect(), receive() и disconnect().
Обертка представляет собой интерфейс Handler, который может быть замененм другим, для обеспечения масштабируемости.

Для каждого типа логгеров создается потокобезопасная очередь задач, куда рабочий класс Bulk добавляет новые данные для логирования. 
К каждой очереди подключаются экземпляры логгеров в режиме конкуренции. 
Когда в очередь попадают новые данные, класс Bulk отправляет оповещение всем логгерам, после чего первый подключившийся логгер логирует данные, после чего убирает данные из очереди.

Для каждого типа логгера своя очередь (для консоли своя, для файлов своя) Это позволяет легко масштабироваться, например, если нужно будет добавить новый тип логирования, достаточно добавить новую очередь, и к этой очереди можно будет подключить любое количество логгеров нового типа.

В программе создаются четыре потока, в трёх из которых работают логгеры. 
Всего в программе, независимо от количества контекстов, существует заранее заданное количество логгеров - два для файлов и один для консоли.
Также, независимо от количества контекстов, существует две потокобезопасные очереди, которые связывают логгеры с контекстом.
Каждый логгер подключается через соответствующую очередь к неограниченному количеству контекстов (классов Bulk) для логирования данных. 

```
+------------+
| контекст_1 |-------+                                     +-------------------+
+------------+       |                             +-------| консольный логгер |
                     |                             |       +-------------------+
                     |    +-----------------+      |
                     +----| очередь консоли |------+
                     |    +-----------------+       
                     |                                     +-------------------+
+------------+       |                             +-------| файловый логгер_1 |
|     ...    |-------+                             |       +-------------------+
+------------+       |                             |
                     |    +------------------+     |       +-------------------+
                     +----| файловая очередь |-----+-------|         ...       |
                     |    +------------------+     |       +-------------------+
                     |                             |
+------------+       |                             |       +-------------------+
| контекст_N |-------+                             +-------| файловый логгер_N |
+------------+                                             +-------------------+

```                                                
                                                    