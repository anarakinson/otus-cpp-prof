# Задание 10
## 10.Переработать программу для пакетной обработки команд таким образом, чтобы ввод данных осуществлялся по сети

Необходимо разработать асинхронный сервер, работающий с протоколом, аналогичным консоли. Сервер принимает команды построчно.

Дальнейшая обработка остаётся без изменений – вывод в консоль и файлы, статический блоки и блоки динамического размера.
В качестве библиотеки сетевого взаимодействия следует использовать библиотеку Boost.ASIO (используем асинхронные возможности).

Поскольку не предполагается отправка данных от сервера клиенту в ответ на команды, основное взаимодействие будет вокруг методов async_read и async_accept.

Порядок запуска:
```shell
bulk_server <port> <bulk_size>
```
где
- port – номер tcp порта для входящих соединений. Соединения должны обслуживаться с произвольных интерфейсов
- bulk_size – размер блока команд.


## Реализовано:

Были добавлены клиент и сервер на asio, которые могут взаимодействовать. Клиент синхронный, сервер - асинхронный. Сервер принимает сообщения и передает их в контекст, в остальном все так же, как было в задании 9.

Порядок запуска:
1. сервер
```shell
bulk_server <port> <bulk_size>
```
2. клиент
```shell
client <ip address> <port>
```

---

Библиотека asynclib предоставляет обертку над рабочими классами, позволяя запускать их в виде отдельных контекстов с помощью команд connect(), receive() и disconnect().
Обертка представляет собой интерфейс Handler, который может быть замененм другим, для обеспечения масштабируемости.

Для каждого типа логгеров создается потокобезопасная очередь задач, куда рабочий класс Bulk добавляет новые данные для логирования. 
К каждой очереди подключаются экземпляры логгеров в режиме конкуренции. 
Когда в очередь попадают новые данные, класс Bulk отправляет оповещение всем логгерам, после чего первый подключившийся логгер логирует данные, после чего убирает данные из очереди.

Для каждого типа логгера своя очередь (для консоли своя, для файлов своя) Это позволяет легко масштабироваться, например, если нужно будет добавить новый тип логирования, достаточно добавить новую очередь, и к этой очереди можно будет подключить любое количество логгеров нового типа.

В программе создаются четыре потока, в трёх из которых работают логгеры. 
Всего в программе, независимо от количества контекстов, существует заранее заданное количество логгеров - два для файлов и один для консоли.
Также, независимо от количества контекстов, существует две потокобезопасные очереди, которые связывают логгеры с контекстом.
Каждый логгер подключается через соответствующую очередь к неограниченному количеству контекстов (классов Bulk) для логирования данных. 

Также ко всем хэндлерам прикрепляется уникальный статический менеджер потоков, в котором создаются и управляются рабочие потоки, логгеры и очереди.
Это позоляет не создавать потоки и очереди вовне, но при этом не создавать лишние потоки при создании каждого нового контекста.

```
                                               +------------------+
                                            +--| менеджер потоков |
                                            |  +------------------+
                                            |   
                                            +----------------+
+-------------+                                              |              
| контекст_1  |-------+                                 +----+----+     +-------------------+
+-------------+       |                             +---| поток 1 |-----| консольный логгер |
                      |                             |   +----+----+     +-------------------+
                      |    +-----------------+      |        |            
                      +----| очередь консоли |------+        |            
                      |    +-----------------+               |            
                      |                                 +----+----+       +-------------------+
+-------------+       |                             +---| поток 2 |-------| файловый логгер_1 |
| контекст... |-------+                             |   +----+----+       +-------------------+
+-------------+       |                             |        |            
                      |    +------------------+     |   +----+----+       +--------------------+
                      +----| файловая очередь |-----+---| поток...|-------| файловый логгер... |
                      |    +------------------+     |   +----+----+       +--------------------+
                      |                             |        |            
+-------------+       |                             |   +----+----+       +-------------------+
| контекст_N  |-------+                             +---| поток N |-------| файловый логгер_N |
+-------------+                                         +---------+       +-------------------+
                
```                                                
                                                    

